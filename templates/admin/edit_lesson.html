{% extends "base.html" %} {% block content %}
<h1>Edit Lesson: {{ lesson.title }}</h1>
<form method="POST" enctype="multipart/form-data">
  <div class="form-group">
    <label for="title">Lesson Title</label>
    <input
      type="text"
      class="form-control"
      id="title"
      name="title"
      value="{{ lesson.title }}"
      required
    />
  </div>
  <div class="form-group">
    <label for="content">Lesson Content</label>
    <textarea
      class="form-control"
      id="content"
      name="content"
      rows="10"
      required
    >
{{ lesson.content }}</textarea
    >
  </div>

  <h3>Videos</h3>
  {% for video in lesson.videos %}
  <div class="video-item">
    <input type="hidden" name="video_id[]" value="{{ video.id }}" />
    <div class="form-group">
      <label>Video Title</label>
      <input
        type="text"
        class="form-control"
        name="video_title[]"
        value="{{ video.title }}"
        required
      />
    </div>
    <div class="form-group">
      <label>Current Video</label>
      <video width="320" height="240" controls>
        <source src="{{ video.url }}" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
    </div>
    <div class="form-group">
      <label>Replace Video (optional)</label>
      <input
        type="file"
        class="form-control-file"
        name="video_file[]"
        accept="video/*"
      />
    </div>
  </div>
  {% endfor %}

  <div id="new-videos">
    <!-- New video fields will be added here dynamically -->
  </div>

  <button type="button" class="btn btn-secondary" id="add-video">
    Add New Video
  </button>

  <button type="submit" class="btn btn-primary mt-3">Update Lesson</button>
</form>

<script>
  document.getElementById("add-video").addEventListener("click", function () {
    var newVideoDiv = document.createElement("div");
    newVideoDiv.className = "video-item mt-3";
    newVideoDiv.innerHTML = `
        <div class="form-group">
            <label>New Video Title</label>
            <input type="text" class="form-control" name="video_title[]" required>
        </div>
        <div class="form-group">
            <label>New Video File</label>
            <input type="file" class="form-control-file" name="video_file[]" accept="video/*" required>
        </div>
    `;
    document.getElementById("new-videos").appendChild(newVideoDiv);
  });
</script>
{% endblock %}
