{% extends 'base.html' %} {% block title %} Raydex Coding Hub - {{ course.title
}} {% endblock %} {% block content %}
<div class="container mt-5">
  <!-- Course Title and Description -->
  <div class="row">
    <div class="col-md-8">
      <h1>{{ course.title }}</h1>
      <p>{{ course.description }}</p>
      <p>Price: ${{ course.price }}</p>
    </div>
    <div class="col-md-4">
      <img
        src="{{ url_for('static', filename='images/' + course.image) }}"
        alt="{{ course.title }}"
        class="img-fluid rounded"
      />
    </div>
  </div>

  <hr />

  <!-- Enrollment Section -->
  {% if current_user.is_authenticated %} {% if enrolled %}
  <!-- Progress Bar for Enrolled Users -->
  <div class="progress mt-3">
    <div
      class="progress-bar"
      role="progressbar"
      style="width: {{ (completed_lessons_count / lessons_count) * 100 }}%"
      aria-valuenow="{{ completed_lessons_count }}"
      aria-valuemin="0"
      aria-valuemax="{{ lessons_count }}"
    >
      {{ completed_lessons_count }} / {{ lessons_count }} Lessons Completed
    </div>
  </div>

  <div class="mt-4">
    <!-- Display "Continue" button if next lesson is available -->
    {% if next_lesson %}
    <a
      href="{{ url_for('lesson', course_id=course.id, lesson_id=next_lesson.id) }}"
      class="btn btn-success"
      >Continue to Next Lesson: {{ next_lesson.title }}</a
    >
    {% else %}
    <p class="text-success">
      Congratulations! You've completed all lessons in this course.
    </p>
    {% endif %}
  </div>

  <!-- Display list of lessons with completion status -->
  <h2 class="mt-4">Course Lessons</h2>
  <ul class="list-group">
    {% for lesson in lessons %}
    <li
      class="list-group-item d-flex justify-content-between align-items-center"
    >
      <a
        href="{{ url_for('lesson', course_id=course.id, lesson_id=lesson.id) }}"
        class="text-decoration-none"
        >{{ lesson.title }}</a
      >
      {% if lesson.id in completed_lessons_ids %}
      <span class="badge bg-success rounded-pill">Completed</span>
      {% else %}
      <span class="badge bg-primary rounded-pill">Pending</span>
      {% endif %}
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <!-- Button to Enroll if not enrolled -->
  <form action="{{ url_for('enroll', course_id=course.id) }}" method="post">
    <button type="submit" class="btn btn-primary mt-3">
      Enroll in this Course
    </button>
  </form>
  {% endif %} {% else %}
  <!-- Prompt to log in if user is not logged in -->
  <p>
    Please <a href="{{ url_for('login') }}">login</a> to enroll in this course
    and track your progress.
  </p>
  {% endif %}

  <hr />

  <!-- Back to Courses Button -->
  <a href="{{ url_for('courses') }}" class="btn btn-secondary mt-3"
    >Back to Courses</a
  >
</div>
{% endblock %}
